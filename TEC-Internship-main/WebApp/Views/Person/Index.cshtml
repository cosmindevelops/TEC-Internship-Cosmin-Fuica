@model IEnumerable<WebApp.Models.PersonDto>

@{
    ViewData["Title"] = "Persons";
    var apiUrl = ViewData["ApiUrl"] as string;
}

<style>

    .container{
        max-width: 95%;
    }
    .custom-table {
        width: 95%;
        max-width: 100%;
        margin: 0 auto;
        overflow-x: auto;
    }

        .custom-table th, .custom-table td {
            text-align: left;
            padding: 15px;
            vertical-align: middle;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }

        .custom-table th {
            background-color: #343a40;
            color: white;
            text-align: center;
        }

        .custom-table td.icon-cell {
            text-align: center;
        }

        .custom-table .edit-icon, .custom-table .delete-icon, .custom-table .save-icon {
            cursor: pointer;
            color: #007bff;
        }

            .custom-table .edit-icon:hover, .custom-table .delete-icon:hover, .custom-table .save-icon:hover {
                color: #0056b3;
            }

        .custom-table input[type="text"] {
            width: calc(100% - 30px);
            padding: 5px;
        }

        .custom-table .form-control {
            margin-bottom: 0;
            padding: 10px;
            font-size: 14px;
        }

        .custom-table tbody tr {
            transition: background-color 0.3s;
        }

            .custom-table tbody tr:hover {
                background-color: #e9ecef;
            }

        .custom-table thead th {
            border-bottom: 2px solid #dee2e6;
        }

        .custom-table .icon-cell a {
            margin-left: 10px;
            margin-right: 10px;
            text-decoration: none;
            color: #007bff;
        }

    td.icon-cell {
        max-width: 10px;
        width: auto;
    }

    .new-person-row {
        text-align: center;
    }

        .new-person-row input {
            width: calc(100% - 30px);
            padding: 10px;
            font-size: 14px;
        }

        .new-person-row .create-icon {
            font-size: 20px;
            margin-left: 10px;
            vertical-align: middle;
            cursor: pointer;
            color: #28a745;
        }

    .column-visibility-controls {
        margin: 20px;
    }
            .new-person-row .create-icon:hover {
                color: #218838;
            }

            .dropdown{
                margin-right: 20px;
            }
            
</style>

<div class="container mt-5">
    <h2 class="text-center">Persons</h2>
    <div class="d-flex justify-content-end column-visibility-controls mb-3">
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="columnDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Display
            </button>
            <div class="dropdown-menu" aria-labelledby="columnDropdown">
                <label class="dropdown-item"><input type="checkbox" data-column="0" checked> Name</label>
                <label class="dropdown-item"><input type="checkbox" data-column="1" checked> Surname</label>
                <label class="dropdown-item"><input type="checkbox" data-column="2" checked> BirthDay</label>
                <label class="dropdown-item"><input type="checkbox" data-column="3" checked> Age</label>
                <label class="dropdown-item"><input type="checkbox" data-column="4" checked> Address</label>
                <label class="dropdown-item"><input type="checkbox" data-column="5" checked> City</label>
                <label class="dropdown-item"><input type="checkbox" data-column="6" checked> Email</label>
                <label class="dropdown-item"><input type="checkbox" data-column="7" checked> Department</label>
                <label class="dropdown-item"><input type="checkbox" data-column="8" checked> Position</label>
                <label class="dropdown-item"><input type="checkbox" data-column="9" checked> Salary</label>
            </div>
        </div>
    </div>
    <form method="post">
        @Html.AntiForgeryToken()
        <table class="table table-striped table-hover custom-table">
            <thead class="thead-dark">
                <tr>
                    <th>Name</th>
                    <th>Surname</th>
                    <th>BirthDay</th>
                    <th>Age</th>
                    <th>Address</th>
                    <th>City</th>
                    <th>Email</th>
                    <th>Department</th>
                    <th>Position</th>
                    <th>Salary</th>
                    <th class="text-right">Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var person in Model)
                {
                    <tr>
                        <td><span>@person.Name</span><input type="text" class="form-control name-input" value="@person.Name" style="display: none;" /></td>
                        <td><span>@person.Surname</span><input type="text" class="form-control surname-input" value="@person.Surname" style="display: none;" /></td>
                        <td><span>@person.BirthDay?.ToString("yyyy-MM-dd")</span><input type="date" class="form-control birthday-input" value="@person.BirthDay?.ToString("yyyy-MM-dd")" style="display: none;" /></td>
                        <td><span>@person.Age</span><input type="number" class="form-control age-input" value="@person.Age" style="display: none;" /></td>
                        <td><span>@person.Address</span><input type="text" class="form-control address-input" value="@person.Address" style="display: none;" /></td>
                        <td><span>@person.PersonCity</span><input type="text" class="form-control personcity-input" value="@person.PersonCity" style="display: none;" /></td>
                        <td><span>@person.Email</span><input type="email" class="form-control email-input" value="@person.Email" style="display: none;" /></td>
                        <td><span>@person.DepartmentName</span><input type="text" class="form-control department-input" value="@person.DepartmentName" style="display: none;" /></td>
                        <td><span>@person.PositionName</span><input type="text" class="form-control position-input" value="@person.PositionName" style="display: none;" /></td>
                        <td><span>@person.SalaryAmount</span><input type="number" class="form-control salary-input" value="@person.SalaryAmount" style="display: none;" /></td>   
                        <td class="icon-cell text-right">
                            <a href="javascript:void(0);" class="edit-icon" data-person-id="@person.Id" title="Edit"><i class="fas fa-edit"></i></a>
                            <a href="javascript:void(0);" class="save-icon" data-person-id="@person.Id" style="display: none;" title="Save"><i class="fas fa-save"></i></a>
                            <a href="javascript:void(0);" class="cancel-icon" data-person-id="@person.Id" style="display: none;" title="Cancel"><i class="fas fa-times"></i></a>
                            <a href="javascript:void(0);" class="delete-icon" data-person-id="@person.Id" title="Delete"><i class="fas fa-trash-alt"></i></a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </form>
</div>



@section Scripts {
    <script>
        const apiUrl = '@apiUrl';
    </script>
    <script src="~/js/person.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <script>
        toastr.options = {
            "positionClass": "toast-bottom-right",
            "timeOut": "2000",
            "closeButton": true,
            "showDuration": "300",
            "hideDuration": "1000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        };
    </script>

}